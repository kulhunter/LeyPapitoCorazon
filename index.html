<!DOCTYPE html>
<html lang="es-CL">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ley Papito Coraz√≥n Explicada en F√°cil | Gu√≠a Definitiva 2024</title>
    
    <!-- SEO METADATA -->
    <meta name="description" content="¬øNo te paga la pensi√≥n? ¬øNo te deja ver a tu hijo? Explicamos la Ley de Responsabilidad Parental (21.484) en chileno simple. Retenci√≥n de AFP, Banco y visitas.">
    <meta name="keywords" content="como cobrar pension alimentos, papito corazon afp, ley 21484 explicada facil, me demandaron por alimentos, no me deja ver a mi hijo, registro nacional de deudores, retencion de impuestos alimentos">
    <meta name="author" content="Defensa Parental Chile">
    
    <!-- SCHEMA.ORG -->
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "FAQPage",
      "mainEntity": [{
        "@type": "Question",
        "name": "¬øMe pueden quitar a mi hijo si gano menos plata que el padre?",
        "acceptedAnswer": {
          "@type": "Answer",
          "text": "NO. La plata no compra el cari√±o ni la habilidad de crianza. El tribunal busca estabilidad emocional, no riqueza."
        }
      }, {
        "@type": "Question",
        "name": "¬øQu√© hago si el pap√° de mi hijo trabaja en negro (sin contrato)?",
        "acceptedAnswer": {
          "@type": "Answer",
          "text": "Se presume que gana el Sueldo M√≠nimo y se le calcula la pensi√≥n sobre eso. Si no paga, se activa la b√∫squeda de patrimonio en bancos o AFP."
        }
      }]
    }
    </script>

    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@300;400;500;700;800;900&family=Roboto+Mono:wght@400;500&display=swap" rel="stylesheet">
    
    <!-- Iconos -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- Three.js -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>

    <!-- AdSense -->
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-7868880098336635" crossorigin="anonymous"></script>

    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['Montserrat', 'sans-serif'],
                        mono: ['Roboto Mono', 'monospace'],
                    },
                    colors: {
                        dark: '#050505', 
                        neonBlue: '#2563eb',
                        neonPurple: '#9333ea',
                        neonPink: '#db2777',
                        legalText: '#94a3b8'
                    },
                    animation: {
                        'pulse-slow': 'pulse 3s cubic-bezier(0.4, 0, 0.6, 1) infinite',
                    }
                }
            }
        }
    </script>

    <style>
        html { scroll-behavior: smooth; }
        body { margin: 0; background-color: #050505; color: #f8fafc; overflow-x: hidden; }
        
        #canvas-container {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            z-index: -1;
            background: radial-gradient(circle at 50% 50%, #171717 0%, #000000 100%);
        }

        .glass-panel {
            background: rgba(20, 20, 20, 0.85);
            backdrop-filter: blur(12px);
            -webkit-backdrop-filter: blur(12px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            box-shadow: 0 20px 50px rgba(0,0,0,0.5);
        }

        .ai-input-container {
            background: linear-gradient(145deg, rgba(255,255,255,0.05) 0%, rgba(255,255,255,0.02) 100%);
            border: 1px solid rgba(255, 255, 255, 0.15);
            box-shadow: 0 0 30px rgba(147, 51, 234, 0.15);
            transition: all 0.3s ease;
        }
        .ai-input-container:focus-within {
            border-color: #9333ea;
            box-shadow: 0 0 50px rgba(147, 51, 234, 0.3);
        }

        .gradient-text {
            background: linear-gradient(to right, #60a5fa, #a855f7, #f472b6);
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
        }

        .simple-explain {
            font-size: 1.5rem;
            line-height: 1.4;
            font-weight: 700;
            color: #ffffff;
            margin-bottom: 0.5rem;
        }
        @media (min-width: 768px) {
            .simple-explain { font-size: 1.8rem; }
        }

        .legal-detail {
            font-family: 'Roboto Mono', monospace;
            font-size: 0.85rem;
            color: #94a3b8;
            background: rgba(0,0,0,0.3);
            padding: 1rem;
            border-left: 2px solid #475569;
            margin-top: 0.5rem;
            display: none; 
        }
        .legal-detail.show { display: block; animation: slideDown 0.3s ease-out; }

        @keyframes slideDown { from { opacity: 0; transform: translateY(-10px); } to { opacity: 1; transform: translateY(0); } }

        .hidden-section { display: none !important; }
        .visible-section { display: block !important; animation: fadeIn 0.5s ease-out forwards; }
        
        @keyframes fadeIn { from { opacity: 0; transform: scale(0.98); } to { opacity: 1; transform: scale(1); } }

        .faq-btn {
            text-align: left;
            width: 100%;
            padding: 1.2rem;
            background: rgba(255,255,255,0.03);
            border: 1px solid rgba(255,255,255,0.05);
            border-radius: 0.75rem;
            transition: all 0.2s;
            cursor: pointer;
            margin-bottom: 1rem;
        }
        .faq-btn:hover { background: rgba(255,255,255,0.08); border-color: rgba(255,255,255,0.2); }
        .faq-answer { display: none; padding: 1rem 1.2rem; color: #cbd5e1; border-left: 3px solid #a855f7; margin-bottom: 2rem; }

        /* Estilos del buscador IA */
        .ai-result {
            background: rgba(0,0,0,0.6);
            border-left: 4px solid #9333ea;
            padding: 1rem;
            margin-bottom: 0.5rem;
            border-radius: 0 0.5rem 0.5rem 0;
            animation: slideDown 0.3s ease-out;
        }
        .ai-highlight {
            color: #e879f9;
            font-weight: bold;
        }
    </style>
</head>
<body class="antialiased">

    <div id="canvas-container"></div>

    <!-- SECCI√ìN 1: EL ATERRIZAJE (LANDING) -->
    <div id="landing-section" class="min-h-screen flex flex-col items-center justify-center p-6 relative z-10 pt-20">
        
        <div class="max-w-4xl w-full text-center space-y-8">
            
            <div class="inline-block bg-white/10 px-4 py-2 rounded-full border border-white/20">
                <span class="text-green-400 font-bold tracking-widest text-xs md:text-sm uppercase"> <i class="fa-solid fa-circle-check mr-2"></i>Actualizado Ley 21.484</span>
            </div>

            <h1 class="text-5xl md:text-8xl font-black text-white leading-tight tracking-tighter">
                LEY PAPITO<br>
                <span class="gradient-text">CORAZ√ìN</span>
            </h1>

            <!-- CEREBRO DIGITAL (BUSCADOR IA) -->
            <div class="w-full max-w-2xl mx-auto mt-8 mb-12 relative z-50">
                <div class="ai-input-container rounded-2xl p-2 flex items-center">
                    <div class="pl-4 pr-2 text-neonPurple animate-pulse-slow">
                        <i class="fa-solid fa-robot text-2xl"></i>
                    </div>
                    <input type="text" id="ai-search-input" 
                        placeholder="Preg√∫ntame sin filtro... (Ej: 'se gasta la plata en u√±as', 'no paga', 'me funaron')" 
                        class="w-full bg-transparent border-none outline-none text-white placeholder-gray-500 py-3 px-2 text-lg font-medium font-sans"
                        onkeypress="handleKeyPress(event)">
                    <button onclick="performSearch()" class="bg-neonPurple hover:bg-purple-600 text-white p-3 rounded-xl transition-colors font-bold">
                        <i class="fa-solid fa-arrow-right"></i>
                    </button>
                </div>
                
                <!-- Resultados de B√∫squeda -->
                <div id="ai-results-container" class="hidden w-full bg-zinc-900/95 border border-white/10 rounded-xl mt-4 p-4 text-left shadow-2xl max-h-[60vh] overflow-y-auto custom-scrollbar absolute top-full left-0">
                    <div class="flex justify-between items-center mb-4 border-b border-white/10 pb-2">
                        <span class="text-xs font-bold text-gray-400 uppercase tracking-wider">Resultados de la IA</span>
                        <button onclick="closeSearch()" class="text-gray-400 hover:text-white"><i class="fa-solid fa-xmark"></i></button>
                    </div>
                    <div id="ai-results-list" class="space-y-2">
                        <!-- Se llena con JS -->
                    </div>
                    <!-- Fallback Google -->
                    <div id="ai-fallback" class="hidden mt-4 pt-4 border-t border-white/10">
                        <p class="text-gray-400 text-sm mb-2">ü§î No encontr√© una respuesta exacta en la gu√≠a...</p>
                        <a id="google-fallback-link" href="#" target="_blank" class="block w-full text-center bg-zinc-800 hover:bg-zinc-700 text-white py-3 rounded-lg transition-colors font-bold border border-white/10">
                            <i class="fa-brands fa-google mr-2 text-red-500"></i> Buscar "<span id="fallback-query"></span>" en Google Chile
                        </a>
                    </div>
                </div>
            </div>

            <p class="text-xl md:text-2xl text-gray-300 font-medium max-w-2xl mx-auto">
                Olv√≠date de leer leyes que nadie entiende. <br>Aqu√≠ hablamos en <strong>chileno simple</strong>.
            </p>

            <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mt-8 max-w-3xl mx-auto">
                <button onclick="enterSite('mama')" class="group relative bg-zinc-900 border border-zinc-800 hover:border-pink-500 rounded-2xl p-8 transition-all hover:scale-[1.02] hover:shadow-[0_0_30px_rgba(236,72,153,0.2)] text-left">
                    <div class="flex justify-between items-start mb-6">
                        <h2 class="text-3xl font-black text-white uppercase italic">Soy<br><span class="text-pink-500">Mam√°</span></h2>
                        <i class="fa-solid fa-person-breastfeeding text-4xl text-zinc-700 group-hover:text-pink-500 transition-colors"></i>
                    </div>
                    <p class="text-gray-400 text-sm font-mono">"Quiero cobrar", "Retenci√≥n AFP", "Registro deudores"</p>
                </button>

                <button onclick="enterSite('papa')" class="group relative bg-zinc-900 border border-zinc-800 hover:border-blue-500 rounded-2xl p-8 transition-all hover:scale-[1.02] hover:shadow-[0_0_30px_rgba(59,130,246,0.2)] text-left">
                    <div class="flex justify-between items-start mb-6">
                        <h2 class="text-3xl font-black text-white uppercase italic">Soy<br><span class="text-blue-500">Pap√°</span></h2>
                        <i class="fa-solid fa-person-hiking text-4xl text-zinc-700 group-hover:text-blue-500 transition-colors"></i>
                    </div>
                    <p class="text-gray-400 text-sm font-mono">"Estoy cesante", "Visitas", "Me demandaron"</p>
                </button>
            </div>
        </div>
        
        <div class="absolute bottom-6 text-zinc-600 text-xs font-mono">
            * Informaci√≥n basada en la Biblioteca del Congreso Nacional de Chile
        </div>
    </div>


    <!-- SECCI√ìN 2: EL CONTENIDO (LA GU√çA) -->
    <div id="guide-ui" class="hidden-section min-h-screen relative z-20 bg-[#050505]">
        
        <header class="fixed top-0 left-0 w-full bg-[#050505]/90 backdrop-blur-md border-b border-white/10 z-50 px-4 py-3 flex justify-between items-center">
            <button onclick="exitSite()" class="text-gray-400 hover:text-white flex items-center gap-2 font-mono text-sm uppercase font-bold transition-colors">
                <i class="fa-solid fa-arrow-left"></i> Volver al Inicio
            </button>
            <div id="profile-badge" class="px-3 py-1 rounded-full text-xs font-black uppercase tracking-wider">
                <!-- Inyectado por JS -->
            </div>
        </header>

        <div class="max-w-7xl mx-auto pt-20 pb-20 px-4 grid grid-cols-1 lg:grid-cols-12 gap-10">
            <aside class="lg:col-span-3 hidden lg:block">
                <nav class="sticky top-24 space-y-2" id="toc-desktop">
                    <!-- Inyectado por JS -->
                </nav>
            </aside>
            <main class="lg:col-span-9 space-y-20" id="main-content">
                <!-- Se inyecta aqu√≠ -->
            </main>
        </div>
    </div>

    <!-- DATOS Y L√ìGICA -->
    <script>
        // --- DATA DE LA GU√çA ---
        const data = {
            mama: {
                badge: '<span class="text-pink-500 bg-pink-500/10 border border-pink-500/20 px-3 py-1 rounded">MODO: MAM√Å</span>',
                theme: 'pink',
                toc: [
                    { t: 'Cobrar la Plata', id: 'cobro' },
                    { t: 'Retenci√≥n AFP', id: 'afp' },
                    { t: 'Miedos Comunes', id: 'miedos' },
                    { t: 'Preguntas Sin Filtro', id: 'faq' }
                ],
                content: `
                    <div id="cobro" class="scroll-mt-24 search-target" data-keywords="cobrar deuda pago no paga banco retencion sii investigacion patrimonio">
                        <h2 class="text-4xl font-black text-white mb-8">COBRAR LA PENSI√ìN (SIN VOLVERSE LOCA)</h2>
                        <!-- Block 1 -->
                        <section class="group scroll-mt-24 mb-12">
                            <div class="flex items-center gap-3 mb-4">
                                <div class="p-2 rounded-lg bg-pink-500/10 text-pink-500"><i class="fa-solid fa-magnifying-glass-dollar text-xl"></i></div>
                                <h3 class="text-zinc-500 font-mono text-sm font-bold uppercase tracking-widest">YA NO TIENES QUE INVESTIGAR T√ö</h3>
                            </div>
                            <div class="simple-explain">Olv√≠date de buscar si se compr√≥ un auto o d√≥nde trabaja. Ahora el Tribunal apreta un bot√≥n y busca la plata en todos los bancos e instituciones financieras de Chile autom√°ticamente.</div>
                            <button onclick="toggleLegal('l1')" class="text-xs font-mono text-pink-400 hover:text-white mt-2 flex items-center gap-2 underline underline-offset-4 decoration-dotted"><i class="fa-solid fa-scale-balanced"></i> Ver detalle legal (Ley 21.484)</button>
                            <div id="l1" class="legal-detail rounded-lg"><strong class="text-zinc-300 block mb-2">Fundamento Legal:</strong>Art√≠culo 19 quater de la Ley 14.908: Establece el "Procedimiento Especial de Cobro". Si existe una deuda de al menos una mensualidad, el tribunal debe investigar de oficio el patrimonio a trav√©s del SII, CMF y otros servicios.</div>
                        </section>

                        <!-- Block 2 -->
                         <section class="group scroll-mt-24 mb-12" data-keywords="registro deudores funa licencia conducir pasaporte credito banco castigo">
                            <div class="flex items-center gap-3 mb-4">
                                <div class="p-2 rounded-lg bg-pink-500/10 text-pink-500"><i class="fa-solid fa-ban text-xl"></i></div>
                                <h3 class="text-zinc-500 font-mono text-sm font-bold uppercase tracking-widest">REGISTRO DE DEUDORES = MUERTE CIVIL</h3>
                            </div>
                            <div class="simple-explain">Si te debe 3 meses seguidos (o 5 salteados), entra al Registro. No podr√° sacar licencia de conducir, ni pasaporte, y si pide un cr√©dito de m√°s de 50 UF, el banco le retiene la plata para pagarte a ti.</div>
                            <button onclick="toggleLegal('l2')" class="text-xs font-mono text-pink-400 hover:text-white mt-2 flex items-center gap-2 underline underline-offset-4 decoration-dotted"><i class="fa-solid fa-scale-balanced"></i> Ver detalle legal</button>
                            <div id="l2" class="legal-detail rounded-lg"><strong class="text-zinc-300 block mb-2">Fundamento Legal:</strong>Ley 21.389 crea el Registro Nacional de Deudores. Establece consecuencias como la retenci√≥n de devoluciones de impuestos, imposibilidad de inscribir veh√≠culos o inmuebles sin acreditar pago.</div>
                        </section>
                    </div>

                    <div id="afp" class="scroll-mt-24 search-target" data-keywords="afp fondos retiro jubilacion plata dinero cuenta capitalizacion">
                        <h2 class="text-4xl font-black text-white mb-8">CUANDO NO TIENE NADA: LA AFP</h2>
                        <section class="group scroll-mt-24 mb-12">
                            <div class="flex items-center gap-3 mb-4">
                                <div class="p-2 rounded-lg bg-pink-500/10 text-pink-500"><i class="fa-solid fa-piggy-bank text-xl"></i></div>
                                <h3 class="text-zinc-500 font-mono text-sm font-bold uppercase tracking-widest">LA √öLTIMA CARTA: TOCAR SUS FONDOS</h3>
                            </div>
                            <div class="simple-explain">Si el tribunal busc√≥ en los bancos y no encontr√≥ nada (o muy poco), AHORA S√ç puedes pedir que le saquen plata de su cuenta obligatoria de AFP para pagarte.</div>
                            <button onclick="toggleLegal('l3')" class="text-xs font-mono text-pink-400 hover:text-white mt-2 flex items-center gap-2 underline underline-offset-4 decoration-dotted"><i class="fa-solid fa-scale-balanced"></i> Ver detalle legal</button>
                            <div id="l3" class="legal-detail rounded-lg"><strong class="text-zinc-300 block mb-2">Fundamento Legal:</strong>Art√≠culo 19 quinquies: Procedimiento Extraordinario. Procede cuando hay 3 pensiones adeudadas y no hay fondos bancarios suficientes.</div>
                        </section>
                    </div>

                    <div id="miedos" class="scroll-mt-24 search-target" data-keywords="quitar hijo tuicion cuidado personal miedo amenaza demanda">
                        <h2 class="text-4xl font-black text-white mb-8">TUS MIEDOS (Y LA VERDAD)</h2>
                        <section class="group scroll-mt-24 mb-12">
                             <div class="flex items-center gap-3 mb-4">
                                <div class="p-2 rounded-lg bg-pink-500/10 text-pink-500"><i class="fa-solid fa-shield-heart text-xl"></i></div>
                                <h3 class="text-zinc-500 font-mono text-sm font-bold uppercase tracking-widest">¬øME PUEDE QUITAR AL NI√ëO?</h3>
                            </div>
                            <div class="simple-explain">NO. La plata y el cuidado son cosas distintas. Que √©l empiece a pagar (obligado) no le da derecho a llevarse al ni√±o ni a pedir la tuici√≥n. Para eso necesitar√≠a probar que t√∫ eres negligente, no que √©l tiene plata.</div>
                        </section>
                    </div>

                    <div id="faq" class="scroll-mt-24 search-target" data-keywords="negro contrato sin trabajo auto nuevo retroactivo">
                        <h2 class="text-4xl font-black text-white mb-8">PREGUNTAS SIN FILTRO</h2>
                        <!-- Pregunta 1 -->
                        <div data-keywords="trabajo negro informal sin contrato">
                            <button onclick="toggleFAQ('f1')" class="faq-btn group"><div class="flex justify-between items-center"><span class="font-bold text-lg text-white group-hover:text-pink-400">"Trabaja 'en negro' y dice que no tiene plata"</span><i class="fa-solid fa-chevron-down text-zinc-500"></i></div></button>
                            <div id="f1" class="faq-answer border-pink-500"><p class="text-lg leading-relaxed">Da lo mismo lo que √©l diga. La ley asume que todo padre tiene capacidad de ganar al menos el Sueldo M√≠nimo. Se le fija la pensi√≥n en base a eso.</p></div>
                        </div>
                        <!-- Pregunta 2 -->
                        <div data-keywords="retroactivo a√±os anteriores deuda antigua">
                            <button onclick="toggleFAQ('f2')" class="faq-btn group"><div class="flex justify-between items-center"><span class="font-bold text-lg text-white group-hover:text-pink-400">"¬øLa pensi√≥n es retroactiva?"</span><i class="fa-solid fa-chevron-down text-zinc-500"></i></div></button>
                            <div id="f2" class="faq-answer border-pink-500"><p class="text-lg leading-relaxed">Solo se debe desde que notificas la demanda. Si nunca lo has demandado legalmente, esos a√±os hacia atr√°s se perdieron. ¬°Demanda hoy!</p></div>
                        </div>
                    </div>
                `
            },
            papa: {
                badge: '<span class="text-blue-500 bg-blue-500/10 border border-blue-500/20 px-3 py-1 rounded">MODO: PAP√Å</span>',
                theme: 'blue',
                toc: [
                    { t: 'Tu Deber (La Plata)', id: 'deber' },
                    { t: 'Visitas y Obstrucci√≥n', id: 'visitas' },
                    { t: 'Qued√© Cesante', id: 'cesante' },
                    { t: 'Preguntas Sin Filtro', id: 'faq' }
                ],
                content: `
                    <div id="deber" class="scroll-mt-24 search-target" data-keywords="pagar por fuera mano regalo deuda obligacion registro">
                         <h2 class="text-4xl font-black text-white mb-8">ENTENDIENDO TU DEUDA</h2>
                         <section class="group scroll-mt-24 mb-12">
                            <div class="flex items-center gap-3 mb-4">
                                <div class="p-2 rounded-lg bg-blue-500/10 text-blue-500"><i class="fa-solid fa-triangle-exclamation text-xl"></i></div>
                                <h3 class="text-zinc-500 font-mono text-sm font-bold uppercase tracking-widest">LOS PAGOS "POR FUERA" NO EXISTEN</h3>
                            </div>
                            <div class="simple-explain">Si le compras zapatillas, pagas el furg√≥n directo o le pasas 50 lucas en la mano... PARA EL JUEZ SIGUES DEBIENDO. Tienes que depositar en la cuenta del BancoEstado que te dio el tribunal.</div>
                            <button onclick="toggleLegal('pl1')" class="text-xs font-mono text-blue-400 hover:text-white mt-2 flex items-center gap-2 underline underline-offset-4 decoration-dotted"><i class="fa-solid fa-scale-balanced"></i> Ver detalle legal</button>
                            <div id="pl1" class="legal-detail rounded-lg"><strong class="text-zinc-300 block mb-2">Fundamento Legal:</strong>El pago de la pensi√≥n debe ser √≠ntegro y oportuno en la cuenta decretada. Los gastos directos no se imputan a la pensi√≥n salvo acuerdo formal.</div>
                        </section>
                    </div>

                    <div id="visitas" class="scroll-mt-24 search-target" data-keywords="visitas ver hijo bloqueo constancia carabineros">
                        <h2 class="text-4xl font-black text-white mb-8">¬øNO TE DEJA VERLO?</h2>
                         <section class="group scroll-mt-24 mb-12">
                            <div class="flex items-center gap-3 mb-4">
                                <div class="p-2 rounded-lg bg-blue-500/10 text-blue-500"><i class="fa-solid fa-child-reaching text-xl"></i></div>
                                <h3 class="text-zinc-500 font-mono text-sm font-bold uppercase tracking-widest">LA PLATA Y LAS VISITAS NO SE MEZCLAN</h3>
                            </div>
                            <div class="simple-explain">Muchos creen que "si no pago no lo veo" o "si no me deja verla no pago". ERROR. Si dejas de pagar como venganza, te conviertes en deudor. Si ella bloquea, demanda cumplimiento de visitas.</div>
                        </section>
                    </div>

                    <div id="cesante" class="scroll-mt-24 search-target" data-keywords="cesante sin pega trabajo despido rebaja">
                        <h2 class="text-4xl font-black text-white mb-8">SOS: QUED√â CESANTE</h2>
                        <section class="group scroll-mt-24 mb-12">
                            <div class="flex items-center gap-3 mb-4">
                                <div class="p-2 rounded-lg bg-blue-500/10 text-blue-500"><i class="fa-solid fa-user-slash text-xl"></i></div>
                                <h3 class="text-zinc-500 font-mono text-sm font-bold uppercase tracking-widest">NO DEJES DE PAGAR EN SILENCIO</h3>
                            </div>
                            <div class="simple-explain">Si te echaron, el tribunal NO lo sabe. Para ellos sigues debiendo el monto completo. Tienes que demandar "REBAJA DE ALIMENTOS" inmediatamente.</div>
                        </section>
                    </div>

                     <div id="faq" class="scroll-mt-24 search-target" data-keywords="gastos u√±as peluqueria otra familia preso carcel sueldo minimo">
                        <h2 class="text-4xl font-black text-white mb-8">PREGUNTAS SIN FILTRO</h2>
                        <div data-keywords="se gasta la plata u√±as peluqueria malgasta">
                             <button onclick="toggleFAQ('pf1')" class="faq-btn group"><div class="flex justify-between items-center"><span class="font-bold text-lg text-white group-hover:text-blue-400">"Ella se gasta la pensi√≥n en peluquer√≠a y u√±as"</span><i class="fa-solid fa-chevron-down text-zinc-500"></i></div></button>
                            <div id="pf1" class="faq-answer border-blue-500"><p class="text-lg leading-relaxed">Si el ni√±o vive con ella, ella paga luz, agua, arriendo, gas y comida. Esos son gastos invisibles. Mientras tu hijo est√© bien cuidado, el tribunal no fiscaliza si ella se compr√≥ un r√≠mel.</p></div>
                        </div>
                        <div data-keywords="preso carcel arresto nocturno">
                             <button onclick="toggleFAQ('pf2')" class="faq-btn group"><div class="flex justify-between items-center"><span class="font-bold text-lg text-white group-hover:text-blue-400">"¬øMe puedo ir preso por no pagar?"</span><i class="fa-solid fa-chevron-down text-zinc-500"></i></div></button>
                            <div id="pf2" class="faq-answer border-blue-500"><p class="text-lg leading-relaxed">S√≠. El arresto nocturno y el arresto total siguen vigentes si los otros m√©todos de cobro fallan.</p></div>
                        </div>
                    </div>
                `
            }
        };

        // --- L√ìGICA DE LA IA (BUSCADOR SEM√ÅNTICO) ---
        function handleKeyPress(e) {
            if (e.key === 'Enter') performSearch();
        }

        function closeSearch() {
            document.getElementById('ai-results-container').classList.add('hidden');
        }

        function performSearch() {
            const query = document.getElementById('ai-search-input').value.toLowerCase().trim();
            const resultsContainer = document.getElementById('ai-results-container');
            const resultsList = document.getElementById('ai-results-list');
            const fallback = document.getElementById('ai-fallback');
            const fallbackLink = document.getElementById('google-fallback-link');
            const fallbackQuerySpan = document.getElementById('fallback-query');

            if (!query) return;

            resultsList.innerHTML = '';
            let matches = [];

            // Diccionario de sin√≥nimos chilensis -> t√©rminos clave
            const synonyms = {
                "plata": "cobro deuda dinero pago",
                "lucas": "cobro deuda dinero pago",
                "funar": "registro deudores",
                "funa": "registro deudores",
                "pega": "trabajo cesante",
                "yiro": "visitas",
                "verlo": "visitas",
                "ex": "papa mama deudor",
                "cago": "deuda problema",
                "carcel": "preso arresto",
                "cana": "preso arresto"
            };

            // Expandir query con sin√≥nimos
            let expandedQuery = query;
            Object.keys(synonyms).forEach(key => {
                if (query.includes(key)) expandedQuery += " " + synonyms[key];
            });

            const keywords = expandedQuery.split(' ');

            // Buscar en ambos perfiles
            ['mama', 'papa'].forEach(profile => {
                // Crear un elemento temporal para parsear el HTML del contenido
                const tempDiv = document.createElement('div');
                tempDiv.innerHTML = data[profile].content;

                // Buscar en secciones marcadas con data-keywords o texto
                const sections = tempDiv.querySelectorAll('.search-target, section, div[data-keywords]');
                
                sections.forEach(section => {
                    let score = 0;
                    // Texto oculto en data-keywords (prioridad)
                    const metaKeywords = section.getAttribute('data-keywords') || "";
                    // Texto visible
                    const visibleText = section.innerText.toLowerCase();
                    
                    keywords.forEach(word => {
                        if (word.length < 3) return; // Ignorar palabras cortas
                        if (metaKeywords.includes(word)) score += 3;
                        if (visibleText.includes(word)) score += 1;
                    });

                    if (score > 0) {
                        // Extraer un t√≠tulo o resumen
                        let title = section.querySelector('h3, h2, span.font-bold')?.innerText || "Informaci√≥n Relacionada";
                        let snippet = visibleText.substring(0, 80) + "...";
                        
                        // Encontrar el ID para el ancla
                        let anchorId = section.id || section.closest('[id]')?.id;
                        
                        // Evitar duplicados toscos
                        if (!matches.some(m => m.anchorId === anchorId && m.profile === profile)) {
                            matches.push({ score, profile, title, snippet, anchorId });
                        }
                    }
                });
            });

            // Ordenar por relevancia
            matches.sort((a, b) => b.score - a.score);
            const topMatches = matches.slice(0, 4); // Top 4 resultados

            if (topMatches.length > 0) {
                fallback.classList.add('hidden');
                topMatches.forEach(match => {
                    const profileColor = match.profile === 'mama' ? 'text-pink-400' : 'text-blue-400';
                    const profileName = match.profile === 'mama' ? 'Perfil Mam√°' : 'Perfil Pap√°';
                    
                    const div = document.createElement('div');
                    div.className = "ai-result cursor-pointer hover:bg-white/5 transition-colors";
                    div.innerHTML = `
                        <div class="text-xs ${profileColor} font-bold uppercase mb-1">${profileName}</div>
                        <div class="font-bold text-white mb-1">${match.title}</div>
                        <div class="text-sm text-gray-400">${match.snippet}</div>
                    `;
                    div.onclick = () => {
                        enterSite(match.profile);
                        setTimeout(() => {
                            const el = document.getElementById(match.anchorId);
                            if (el) {
                                el.scrollIntoView({behavior: 'smooth', block: 'center'});
                                el.classList.add('animate-pulse'); // Highlight visual
                            }
                        }, 500);
                    };
                    resultsList.appendChild(div);
                });
            } else {
                // FALLBACK GOOGLE
                fallback.classList.remove('hidden');
                fallbackQuerySpan.innerText = query;
                // Generar link de b√∫squeda espec√≠fico para Chile + legal
                const googleQuery = encodeURIComponent(`ley responsabilidad parental chile ${query}`);
                fallbackLink.href = `https://www.google.com/search?q=${googleQuery}`;
            }

            resultsContainer.classList.remove('hidden');
        }

        // --- L√ìGICA DE NAVEGACI√ìN ---
        const landing = document.getElementById('landing-section');
        const guide = document.getElementById('guide-ui');
        const mainContent = document.getElementById('main-content');
        const tocDesktop = document.getElementById('toc-desktop');
        const badge = document.getElementById('profile-badge');

        function enterSite(profile) {
            landing.style.opacity = '0';
            setTimeout(() => {
                landing.classList.add('hidden-section');
                const info = data[profile];
                badge.innerHTML = info.badge;
                tocDesktop.innerHTML = `
                    <p class="text-zinc-500 text-xs font-black uppercase tracking-widest mb-4 ml-2">√çndice</p>
                    ${info.toc.map(item => `
                        <a href="#${item.id}" class="block px-3 py-2 text-sm text-gray-400 hover:text-white hover:bg-white/5 rounded-lg transition-all border-l-2 border-transparent hover:border-${info.theme}-500">
                            ${item.t}
                        </a>
                    `).join('')}
                `;
                mainContent.innerHTML = info.content;
                guide.classList.remove('hidden-section');
                guide.classList.add('visible-section');
                window.scrollTo(0,0);
            }, 300);
        }

        function exitSite() {
            guide.classList.remove('visible-section');
            guide.classList.add('hidden-section');
            landing.classList.remove('hidden-section');
            setTimeout(() => { landing.style.opacity = '1'; }, 10);
        }

        function toggleLegal(id) {
            const el = document.getElementById(id);
            if (el.classList.contains('show')) {
                el.classList.remove('show');
                setTimeout(() => el.style.display = 'none', 300);
            } else {
                el.style.display = 'block';
                setTimeout(() => el.classList.add('show'), 10);
            }
        }

        function toggleFAQ(id) {
            const el = document.getElementById(id);
            if (el.style.display === 'block') {
                el.style.display = 'none';
            } else {
                el.style.display = 'block';
                el.classList.add('animate-[fadeIn_0.3s_ease-out]');
            }
        }

        // --- THREE.JS BACKGROUND ---
        const scene = new THREE.Scene();
        const camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
        const renderer = new THREE.WebGLRenderer({ alpha: true, antialias: true });
        renderer.setSize(window.innerWidth, window.innerHeight);
        document.getElementById('canvas-container').appendChild(renderer.domElement);
        const geometry = new THREE.IcosahedronGeometry(15, 1);
        const material = new THREE.MeshBasicMaterial({ color: 0x333333, wireframe: true, transparent: true, opacity: 0.05 });
        const sphere = new THREE.Mesh(geometry, material);
        scene.add(sphere);
        const pGeo = new THREE.BufferGeometry();
        const pCount = 600;
        const pPos = new Float32Array(pCount * 3);
        for(let i=0; i<pCount*3; i++) pPos[i] = (Math.random()-0.5)*100;
        pGeo.setAttribute('position', new THREE.BufferAttribute(pPos, 3));
        const pMat = new THREE.PointsMaterial({ size: 0.1, color: 0x444444 });
        const particles = new THREE.Points(pGeo, pMat);
        scene.add(particles);
        camera.position.z = 30;
        function animate() {
            requestAnimationFrame(animate);
            sphere.rotation.y += 0.001;
            sphere.rotation.x -= 0.0005;
            particles.rotation.y += 0.0002;
            renderer.render(scene, camera);
        }
        animate();
        window.addEventListener('resize', () => {
            camera.aspect = window.innerWidth / window.innerHeight;
            camera.updateProjectionMatrix();
            renderer.setSize(window.innerWidth, window.innerHeight);
        });
    </script>
</body>
</html>
