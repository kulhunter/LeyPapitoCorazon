<!DOCTYPE html>
<html lang="es-CL">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ley Papito Corazón 2025 | Guía Legal Completa y Actualizada (Chile)</title>
    
    <!-- SEO ESTRATÉGICO -->
    <meta name="description" content="Guía Definitiva de la Ley 21.484 (Papito Corazón). Aprende a solicitar retención de fondos, AFP, y cobro de pensión de alimentos en Chile. Asesoría legal gratuita con IA.">
    <meta name="keywords" content="ley papito corazon, ley 21484, pensión de alimentos chile, retención afp, registro nacional de deudores, deuda alimentos, tribunal de familia, tramite facil pjud, cuidado personal, visitas, abogados de familia gratis">
    <meta name="author" content="solucionador.cl">
    <meta name="robots" content="index, follow">
    
    <!-- Open Graph -->
    <meta property="og:type" content="website">
    <meta property="og:title" content="Ley Papito Corazón: Recupera tu Pensión de Alimentos">
    <meta property="og:description" content="¿Te deben pensión? La nueva Ley 21.484 permite que el Tribunal busque los fondos por ti. Entra y asesórate gratis con nuestra IA Jurídica.">
    <meta property="og:image" content="https://solucionador.cl/assets/share-image.jpg">

    <!-- Twitter -->
    <meta property="twitter:card" content="summary_large_image">
    <meta property="twitter:title" content="Guía Ley Papito Corazón Chile">
    
    <!-- Google AdSense Standard -->
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-7868880098336635" crossorigin="anonymous"></script>

    <!-- Google AdSense AMP -->
    <script async custom-element="amp-auto-ads" src="https://cdn.ampproject.org/v0/amp-auto-ads-0.1.js"></script>

    <!-- Fonts & Icons -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;600;800&family=Lato:wght@300;400;700&family=Merriweather:ital,wght@0,300;0,400;1,300&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- Libraries -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>

    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: { sans: ['Montserrat', 'sans-serif'], body: ['Lato', 'sans-serif'], serif: ['Merriweather', 'serif'] },
                    colors: { slate: { 850: '#1e293b', 900: '#0f172a' }, brand: { purple: '#8b5cf6', pink: '#ec4899', blue: '#3b82f6' } }
                }
            }
        }
    </script>

    <style>
        body { background-color: #0f172a; color: #f1f5f9; font-family: 'Lato', sans-serif; overflow-x: hidden; }
        #canvas-container { position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: -1; background: radial-gradient(circle at 50% 30%, #1e293b 0%, #0f172a 100%); }
        
        .ai-input-wrapper {
            background: rgba(30, 41, 59, 0.95);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(139, 92, 246, 0.3); border-radius: 20px;
            transition: all 0.3s ease; box-shadow: 0 4px 20px rgba(0, 0, 0, 0.4);
            position: relative; z-index: 60;
        }
        .ai-input-wrapper:focus-within { border-color: #ec4899; box-shadow: 0 0 25px rgba(236, 72, 153, 0.2); }
        
        /* TARJETA RESULTADOS OPTIMIZADA */
        .ai-result-card {
            background-color: #0f172a !important; 
            border: 1px solid rgba(139, 92, 246, 0.5);
            border-left: 4px solid #8b5cf6; 
            padding: 1.5rem 1.5rem 0.5rem 1.5rem; 
            border-radius: 12px; 
            margin-top: 1.5rem;
            animation: slideUp 0.3s ease-out; 
            box-shadow: 0 25px 60px rgba(0,0,0,1); 
            position: relative;
            z-index: 1000;
            overflow: visible !important; 
        }
        
        .ai-result-content {
            max-height: 60vh;
            overflow-y: auto;
            padding-bottom: 1rem;
            padding-right: 0.5rem; 
        }

        .result-badge {
            position: absolute;
            top: -12px;
            left: 12px;
            padding: 4px 12px;
            border-radius: 9999px;
            font-size: 10px;
            font-weight: 800;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            color: white;
            box-shadow: 0 4px 10px rgba(0,0,0,0.5);
            white-space: nowrap; 
            z-index: 1001;
        }

        #ai-results-panel {
            z-index: 1000; 
            position: absolute;
            width: 100%;
        }

        @keyframes slideUp { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

        .gradient-title { background: linear-gradient(135deg, #ffffff 0%, #d8b4fe 50%, #f472b6 100%); -webkit-background-clip: text; background-clip: text; color: transparent; }
        .hidden { display: none !important; }
        .visible-section { display: block !important; animation: fadeIn 0.5s ease-out forwards; }
        @keyframes fadeIn { from { opacity: 0; transform: scale(0.99); } to { opacity: 1; transform: scale(1); } }
        
        .typing-indicator span { display: inline-block; width: 8px; height: 8px; background-color: #a855f7; border-radius: 50%; animation: typing 1s infinite; margin: 0 2px; }
        .typing-indicator span:nth-child(2) { animation-delay: 0.2s; }
        .typing-indicator span:nth-child(3) { animation-delay: 0.4s; }
        @keyframes typing { 0%, 100% { transform: translateY(0); opacity: 0.5; } 50% { transform: translateY(-5px); opacity: 1; } }

        .ad-slot {
            width: 100%; min-height: 100px; background: rgba(30, 41, 59, 0.3); border: 1px dashed rgba(255,255,255,0.1);
            display: flex; align-items: center; justify-content: center; margin: 2rem 0; color: #64748b; font-size: 0.8rem; border-radius: 8px;
        }
        
        .ai-result-content::-webkit-scrollbar { width: 6px; }
        .ai-result-content::-webkit-scrollbar-track { background: rgba(255,255,255,0.05); border-radius: 3px; }
        .ai-result-content::-webkit-scrollbar-thumb { background: rgba(139, 92, 246, 0.5); border-radius: 3px; }
    </style>
</head>
<body class="antialiased">
    <amp-auto-ads type="adsense" data-ad-client="ca-pub-7868880098336635"></amp-auto-ads>

    <div id="canvas-container"></div>

    <div id="landing-section" class="min-h-screen flex flex-col items-center justify-center p-4 relative z-10">
        
        <div class="mb-8" id="db-status">
            <span class="bg-slate-800/80 border border-slate-600 px-4 py-2 rounded-full text-xs font-bold text-gray-400 flex items-center gap-2">
                <i class="fa-solid fa-database animate-pulse"></i> Iniciando Sistema Legal...
            </span>
        </div>

        <h1 class="text-5xl md:text-7xl font-black text-center mb-4 tracking-tight">
            LEY PAPITO <span class="gradient-title">CORAZÓN</span>
        </h1>
        
        <p class="text-slate-300 mb-8 text-center max-w-xl text-lg font-light">
            Guía definitiva de la <strong>Ley 21.484</strong>. Asesoría legal inteligente, gratuita y anónima sobre pensión de alimentos en Chile.
        </p>

        <!-- PUBLICIDAD -->
        <div class="ad-slot max-w-2xl"><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-7868880098336635" data-ad-slot="XXXXXXXXXX" data-ad-format="auto" data-full-width-responsive="true"></ins><span class="opacity-50">Publicidad</span></div>

        <!-- INPUT IA -->
        <div class="w-full max-w-2xl relative z-50 mb-12">
            <div class="ai-input-wrapper flex items-center p-2">
                <div class="pl-4 pr-3 text-brand-purple text-2xl"><i class="fa-solid fa-gavel"></i></div>
                <input type="text" id="ai-search-input" 
                    placeholder="Ej: 'no paga pensión', 'abuela cuida al niño', 'garabatos'..." 
                    class="w-full bg-transparent border-none outline-none text-white placeholder-slate-400 text-lg py-3"
                    onkeypress="handleKeyPress(event)" autocomplete="off">
                <button onclick="performSearch()" class="bg-gradient-to-r from-purple-600 to-pink-600 text-white p-3 px-6 rounded-xl font-bold hover:scale-105 transition-transform">
                    Consultar IA
                </button>
            </div>
            <!-- RESULTADOS -->
            <div id="ai-results-panel" class="hidden top-full left-0 w-full mt-4"></div>
        </div>

        <!-- ACCESOS RÁPIDOS -->
        <div class="grid grid-cols-1 md:grid-cols-2 gap-4 w-full max-w-3xl relative z-10"> 
            <button onclick="enterSite('mama')" class="bg-slate-800/50 hover:bg-slate-800 border border-slate-700 hover:border-pink-500 p-6 rounded-2xl text-left transition-all group">
                <h3 class="text-xl font-black text-white group-hover:text-pink-400">SOY MAMÁ <i class="fa-solid fa-venus ml-2"></i></h3>
                <p class="text-sm text-slate-400">Cómo cobrar, Retenciones, Miedos</p>
            </button>
            <button onclick="enterSite('papa')" class="bg-slate-800/50 hover:bg-slate-800 border border-slate-700 hover:border-blue-500 p-6 rounded-2xl text-left transition-all group">
                <h3 class="text-xl font-black text-white group-hover:text-blue-400">SOY PAPÁ <i class="fa-solid fa-mars ml-2"></i></h3>
                <p class="text-sm text-slate-400">Deuda, Defensa, Visitas</p>
            </button>
        </div>
    </div>

    <!-- CONTENIDO GUÍA -->
    <div id="guide-ui" class="hidden min-h-screen bg-[#0f172a] relative z-20">
        <header class="fixed top-0 w-full bg-[#0f172a]/95 backdrop-blur border-b border-slate-800 z-40 px-4 py-4 flex justify-between items-center">
            <button onclick="exitSite()" class="text-slate-400 hover:text-white font-bold text-sm uppercase flex items-center gap-2">
                <i class="fa-solid fa-arrow-left"></i> Volver
            </button>
            <div id="profile-badge"></div>
        </header>
        <div class="max-w-5xl mx-auto pt-24 px-4 pb-20">
            <main id="main-content" class="space-y-12"></main>
        </div>
    </div>

    <!-- LÓGICA DE INTELIGENCIA ARTIFICIAL -->
    <script>
        // 
        const apiKey = "AIzaSyArHwc0NJbfG9a0Eepu2ZRsjVwOSv6Mr-U"; // <--- EJ: "AIzaSyD..." (SIN ESTO, SOLO FUNCIONA EL RESPALDO OFFLINE)
        
        let leyesDB = []; 

        const fallbackLeyes = [
          {
            "id": "LEY-21484",
            "nombre": "Ley de Responsabilidad Parental (Papito Corazón)",
            "palabras_clave": ["retención", "bancos", "afp", "investigación", "patrimonio", "cobro", "automático", "pjud"],
            "resumen": "Establece un mecanismo de investigación automática. El tribunal debe buscar fondos en bancos e instituciones financieras para pagar la deuda.",
            "articulos_clave": [
              { "articulo": "Art. 19 quater", "texto": "El tribunal investigará el patrimonio del deudor a través de la interconexión con el SII, CMF y otras instituciones." },
              { "articulo": "Retención", "texto": "Si se detectan fondos, el juez ordenará la retención inmediata para asegurar el pago." }
            ]
          },
          {
            "id": "LEY-14908",
            "nombre": "Ley de Pago de Alimentos",
            "palabras_clave": ["arresto", "arraigo", "licencia", "registro", "deudores", "cesante", "mínimo", "informal", "negro", "papito"],
            "resumen": "Regula los montos, la forma de pago y los castigos por no pagar la pensión.",
            "articulos_clave": [
              { "articulo": "Presunción", "texto": "Si no hay contrato, se presume que gana el Sueldo Mínimo y se calcula sobre eso." },
              { "articulo": "Registro Nacional", "texto": "Quienes deban 3 meses continuos o 5 discontinuos ingresarán al Registro." }
            ]
          },
          {
            "id": "CODIGO-CIVIL",
            "nombre": "Código Civil (Cuidado Personal)",
            "palabras_clave": ["cuidado personal", "tuición", "visitas", "relación directa", "regular", "abuela", "vive con"],
            "resumen": "Normas sobre quién vive con el hijo y el derecho a visitarlo.",
            "articulos_clave": [
              { "articulo": "Art. 225", "texto": "El cuidado personal corresponde a quien conviva con el hijo. Si vive con abuelos, se debe regularizar." },
              { "articulo": "Visitas", "texto": "Es un derecho del niño ver a su padre/madre, aunque exista deuda." }
            ]
          },
          {
            "id": "LEY-VIF",
            "nombre": "Ley de Violencia Intrafamiliar",
            "palabras_clave": ["violencia", "golpes", "amenazas", "miedo", "riesgo", "pega", "insultos", "gritar"],
            "resumen": "Sanciona el maltrato y protege a las víctimas.",
            "articulos_clave": [
              { "articulo": "Cautelares", "texto": "Ante riesgo, el tribunal debe decretar orden de alejamiento inmediata." }
            ]
          }
        ];

        async function loadLeyesDB() {
            const statusDiv = document.getElementById('db-status');
            try {
                const response = await fetch('leyes_familia_chile.json');
                if (response.ok) {
                    leyesDB = await response.json();
                    statusDiv.innerHTML = `<span class="bg-slate-800/80 border border-green-500/30 px-4 py-2 rounded-full text-xs font-bold text-white flex items-center gap-2"><i class="fa-solid fa-database text-green-400"></i> Base Legal Conectada</span>`;
                } else { throw new Error("Fallback"); }
            } catch (error) {
                console.warn("⚠️ Usando base interna");
                leyesDB = fallbackLeyes;
                statusDiv.innerHTML = `<span class="bg-slate-800/80 border border-yellow-500/30 px-4 py-2 rounded-full text-xs font-bold text-yellow-200 flex items-center gap-2"><i class="fa-solid fa-server"></i> Sistema Legal Interno</span>`;
            }
        }
        loadLeyesDB();

        async function performSearch() {
            const queryInput = document.getElementById('ai-search-input');
            const query = queryInput.value.toLowerCase().trim();
            const panel = document.getElementById('ai-results-panel');
            
            if(!query) return;

            panel.innerHTML = `<div class="ai-result-card text-center"><div class="flex flex-col items-center py-4"><div class="typing-indicator mb-2"><span></span><span></span><span></span></div><p class="text-xs font-bold text-slate-500 uppercase">Analizando...</p></div></div>`;
            panel.classList.remove('hidden');

            // 1. DETECTOR DE INTENCIÓN (SENTIDO COMÚN)
            if (query.match(/(weon|conche|estupid|tonto|mierda|puta|culiao|maraca|ctm|aweona)/i)) {
                setTimeout(() => renderResult("Mmm... Entiendo tu rabia.", "Detecto palabras fuertes. Sé que los temas de familia generan frustración. <br><br>Soy una IA programada para ayudarte legalmente, no para juzgarte. Pregúntame sobre 'deuda', 'visitas' o 'retenciones' para poder ayudarte de verdad.", "IA Empática", "shield-heart", "purple"), 600);
                return;
            }
            if (query.match(/^(hola|buenas|alo|quien eres)/i)) {
                setTimeout(() => renderResult("¡Hola! Soy tu Asistente Legal.", "Soy una IA especializada en la Ley 21.484. Puedo explicarte cómo cobrar pensiones, qué hacer si estás cesante o cómo ver a tus hijos. ¿Cuál es tu duda?", "Asistente Virtual", "robot", "blue"), 600);
                return;
            }

            // 2. INTENTO ONLINE (CON RAG - USO DE TU JSON)
            if (apiKey && apiKey.length > 5) {
                try {
                    // AQUÍ OCURRE LA MAGIA: Le pasamos tu JSON a la IA Real
                    const aiResponse = await fetchGeminiResponse(query);
                    renderResult("Análisis IA (Online)", aiResponse, "Inteligencia Artificial (Gemini)", "robot", "purple");
                    return;
                } catch (e) { console.log("API falló, usando respaldo local..."); }
            } else {
                console.warn("⚠️ FALTA API KEY: Usando modo offline. Para activar la IA Real, pega tu API KEY en la línea de código.");
            }

            // 3. MODO OFFLINE (RESPALDO)
            const offlineResponse = getOfflineResponse(query);
            setTimeout(() => { renderResult(offlineResponse.title, offlineResponse.text, offlineResponse.source, offlineResponse.icon, offlineResponse.color); }, 600);
        }

        // --- CEREBRO HÍBRIDO (ONLINE + RAG) ---
        async function fetchGeminiResponse(userQuery) {
            // 1. Buscamos contexto relevante en el JSON local primero
            let context = "";
            if (leyesDB.length > 0) {
                const relevantLaws = leyesDB.filter(ley => ley.palabras_clave.some(k => userQuery.includes(k)));
                if (relevantLaws.length > 0) {
                    context = "CONTEXTO LEGAL CHILENO (USAR COMO BASE):\n" + relevantLaws.map(l => `- ${l.nombre}: ${l.resumen}`).join('\n');
                }
            }

            const endpoint = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-09-2025:generateContent?key=${apiKey}`;
            const systemPrompt = `Eres un abogado experto en Derecho de Familia Chileno (Ley 21.484). ${context} Instrucciones: Responde breve, empático y citando la ley.`;
            
            const payload = { contents: [{ parts: [{ text: userQuery }] }], systemInstruction: { parts: [{ text: systemPrompt }] } };
            const response = await fetch(endpoint, { method: 'POST', headers: {'Content-Type': 'application/json'}, body: JSON.stringify(payload) });
            if(!response.ok) throw new Error("Error API");
            const data = await response.json();
            return data.candidates?.[0]?.content?.parts?.[0]?.text || "Sin respuesta";
        }

        function getOfflineResponse(query) {
            if (leyesDB.length > 0) {
                const leyMatch = leyesDB.find(ley => ley.palabras_clave && ley.palabras_clave.some(k => query.includes(k)));
                if (leyMatch) {
                    let articulosHTML = "";
                    if(leyMatch.articulos_clave) {
                        articulosHTML = leyMatch.articulos_clave.map(a => `<div class="mt-3 p-3 bg-slate-800/50 rounded border border-slate-700"><strong class="text-pink-400 block mb-1 text-xs uppercase">${a.articulo}</strong><span class="text-slate-300 italic text-sm">"${a.texto}"</span></div>`).join('');
                    }
                    return { title: leyMatch.nombre, text: `${leyMatch.resumen}<br>${articulosHTML}`, source: "Respaldo Legal (Sin Conexión)", icon: "book-atlas", color: "blue" };
                }
            }
            let fallbackText = "No encontré una ley exacta para tu búsqueda en mi base de datos desconectada.";
            if(query.includes("pagar")) fallbackText = "Si tu duda es sobre pagos, recuerda: Solo vale el depósito en la cuenta del BancoEstado.";
            else if (query.includes("hijo")) fallbackText = "Todo se rige por el Interés Superior del Niño. Tienen derecho a alimentos y visitas.";
            
            return { title: "Orientación General", text: `${fallbackText}<br><br><span class="text-xs text-slate-500">Consejo: Usa palabras clave como 'deuda', 'visitas'. Activa la IA Real para respuestas completas.</span>`, source: "Asistente Básico", icon: "circle-info", color: "gray" };
        }

        function renderResult(title, text, source, icon, colorName) {
            const panel = document.getElementById('ai-results-panel');
            const colors = { purple: "border-purple-500 bg-slate-900", blue: "border-blue-500 bg-slate-900", gray: "border-slate-500 bg-slate-900", green: "border-green-500 bg-slate-900" };
            const badgeColors = { purple: "bg-purple-600", blue: "bg-blue-600", gray: "bg-slate-600", green: "bg-green-600" };
            const borderClass = colors[colorName] || colors.gray;
            const badgeBg = badgeColors[colorName] || badgeColors.gray;

            panel.innerHTML = `<div class="ai-result-card relative border-l-4 ${borderClass}"><div class="result-badge ${badgeBg}"><i class="fa-solid fa-${icon} mr-1"></i> ${source}</div><button onclick="document.getElementById('ai-results-panel').classList.add('hidden')" class="absolute top-2 right-2 text-slate-400 hover:text-white p-2 z-50"><i class="fa-solid fa-xmark"></i></button><div class="ai-result-content mt-2"><h3 class="text-white font-bold text-lg mt-1 mb-2">${title}</h3><div class="text-slate-200 text-sm leading-relaxed">${text}</div></div></div>`;
        }

        const contentData = {
            mama: { html: `<div class="animate-fadeIn max-w-4xl mx-auto"><h2 class="text-3xl font-black text-white mb-6 text-pink-500">Guía para Madres</h2><div class="bg-slate-800 p-6 rounded-xl border border-slate-700 mb-6"><h3 class="text-xl font-bold text-white mb-2">1. Cobro Automático</h3><p class="text-slate-300">La Ley 21.484 obliga al tribunal a buscar fondos en todos los bancos.</p></div></div>` },
            papa: { html: `<div class="animate-fadeIn max-w-4xl mx-auto"><h2 class="text-3xl font-black text-white mb-6 text-blue-500">Guía para Padres</h2><div class="bg-slate-800 p-6 rounded-xl border border-slate-700 mb-6"><h3 class="text-xl font-bold text-white mb-2">1. Paga en BancoEstado</h3><p class="text-slate-300">Si pagas en mano, es un regalo. Deposita siempre en la cuenta oficial.</p></div></div>` }
        };
        function enterSite(p){document.getElementById('main-content').innerHTML=contentData[p].html;document.getElementById('landing-section').classList.add('hidden');document.getElementById('guide-ui').classList.remove('hidden');document.getElementById('guide-ui').classList.add('visible-section');window.scrollTo(0,0);}
        function exitSite(){document.getElementById('guide-ui').classList.add('hidden');document.getElementById('guide-ui').classList.remove('visible-section');document.getElementById('landing-section').classList.remove('hidden');}
        function handleKeyPress(e){if(e.key==='Enter')performSearch();}
        
        const scene=new THREE.Scene();const camera=new THREE.PerspectiveCamera(75,window.innerWidth/window.innerHeight,0.1,1000);const renderer=new THREE.WebGLRenderer({alpha:true,antialias:true});renderer.setSize(window.innerWidth,window.innerHeight);document.getElementById('canvas-container').appendChild(renderer.domElement);const particles=new THREE.Group();const geo=new THREE.SphereGeometry(0.05,8,8);const mat=new THREE.MeshBasicMaterial({color:0x64748b});for(let i=0;i<200;i++){const mesh=new THREE.Mesh(geo,mat);mesh.position.set((Math.random()-0.5)*30,(Math.random()-0.5)*30,(Math.random()-0.5)*30);particles.add(mesh);}scene.add(particles);camera.position.z=15;function animate(){requestAnimationFrame(animate);particles.rotation.y+=0.0005;renderer.render(scene,camera);}animate();window.addEventListener('resize',()=>{camera.aspect=window.innerWidth/window.innerHeight;camera.updateProjectionMatrix();renderer.setSize(window.innerWidth,window.innerHeight);});
    </script>
</body>
</html>
